<app-nav-bar></app-nav-bar>

<div class="container" style="margin-top: 100px;">
    <h1 *ngIf="(accoutService.currentUser$ | async) as user">Testni pozdrav: Zdravo {{user.username | titlecase}}</h1>
</div>

<div class="container">
    <h1 style="color:#5E5BF4 ;">
        Projects
    </h1>
    <div class="row">
        <table class="table" style="text-align: center;">
            <thead>
                <tr>
                    <th scope="col"><i class="fa-solid fa-star" style="color: #000;"></i></th>
                    <th scope="col">Name</th>
                    <th scope="col">Key</th>
                    <th scope="col">Type</th>
                    <th scope="col">Lead</th>
                    <th scope="col"></th>
                </tr>
            </thead>
            <tbody>
                <ng-container *ngFor="let project of projects">
                    <tr>
                        <td><input type="checkbox" id="star-checkbox" [checked]="project.isFavorite"></td>
                        <td (click)="toProject()">{{project.name}}</td>
                        <td>{{project.key}}</td>
                        <td>{{project.type}}</td> 
                        <td>{{project.owner.username}}</td>
                        <td><button class="btn btn-primary" (click)="toggleRow(project)"><i class="fas fa-chevron-down"></i></button></td>
                    </tr>
                    <tr *ngIf="project.isExtanded && project.subProjects.length != 0">
                        <td colspan="5">
                            <table class="table" style="margin-bottom: 0;">
                                <tr *ngFor="let subproject of project.subProjects">
                                    <td><i class="fa-solid fa-turn-up fa-rotate-90"></i></td>
                                    <td>{{subproject.name}}</td>
                                    <td>{{subproject.key}}</td>
                                    <td>{{subproject.type}}</td> 
                                    <td>{{subproject.owner.username}}</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </ng-container>
            </tbody>
        </table>
    </div>
</div>